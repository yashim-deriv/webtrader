{"version":3,"sources":["../../../../src/banners/banners.es6"],"names":["shouldShowBanner","auth","has_mf","account_list","filter","item","landing_company_name","length","has_mlt","has_iom","current_loginId","local_storage","get","loginid","getLoginId","loginids","id","is_mf","is_virtual","init","banner","$","$banner","i18n","nav","find","after","go_to_deriv_el","document","getElementById","href","getDerivUrl","showBanner","liveapi","cached","send","website_status","then","status","client_country","clients_country","authorize","res","country","landing_company","data","isEuCountry","isEuCountrySelected","classList","remove","add","response","events","on"],"mappings":";;;;;;;;;;;;;;;;;;AAKA,MAAMA,mBAAmB,SAAnBA,gBAAmB,CAACC,IAAD,EAAU;AACjC,QAAMC,SAAUD,KAAKE,YAAL,CAAkBC,MAAlB,CAA0B;AAAA,aAAQC,KAAKC,oBAAL,KAA8B,aAAtC;AAAA,KAA1B,EAA+EC,MAA/F;AACA,QAAMC,UAAUP,KAAKE,YAAL,CAAkBC,MAAlB,CAA0B;AAAA,aAAQC,KAAKC,oBAAL,KAA8B,OAAtC;AAAA,KAA1B,EAAyEC,MAAzF;AACA,QAAME,UAAUR,KAAKE,YAAL,CAAkBC,MAAlB,CAA0B;AAAA,aAAQC,KAAKC,oBAAL,KAA8B,KAAtC;AAAA,KAA1B,EAAuEC,MAAvF;AACA,QAAMG,kBAAmBC,cAAcC,GAAd,CAAkB,WAAlB,EAA+BC,OAAxD;AACA,QAAMC,aAAaC,WAAWX,MAAX,CAAmB;AAAA,aAAQC,KAAKW,EAAL,KAAYN,eAApB;AAAA,KAAnB,CAAnB;AACA,QAAMO,QAAQH,WAAW,CAAX,EAAcG,KAA5B;AACA,QAAMC,aAAaJ,WAAW,CAAX,EAAcI,UAAjC;AACA,QAAID,KAAJ,EAAW;AACT,aAAO,IAAP;AACD,KAFD,MAEO,IAAIC,cAAchB,MAAd,IAAwB,CAACO,OAAzB,IAAoC,CAACD,OAAzC,EAAkD;AACvD,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD,GAdD;;AAgBO,MAAMW,sBAAO,SAAPA,IAAO,GAAM;AACxB,QAAMC,SAASC,EAAEC,iBAAF,EAAWC,IAAX,EAAf;AACA,QAAMC,MAAMH,EAAE,MAAF,EAAUI,IAAV,CAAe,KAAf,CAAZ;AACAD,QAAIE,KAAJ,CAAUN,MAAV;AACA,QAAMO,iBAAiBC,SAASC,cAAT,CAAwB,sBAAxB,CAAvB;AACAF,mBAAeG,IAAf,GAAsBC,YAAY,EAAZ,CAAtB;AACAC;AACD,GAPM;;AASP,MAAMA,aAAa,SAAbA,UAAa,GAAM;AACvB,QAAMZ,SAASQ,SAASC,cAAT,CAAwB,wBAAxB,CAAf;AACAI,gCAAQC,MAAR,CAAeC,IAAf,CAAoB,EAAEC,gBAAgB,CAAlB,EAApB,EAA2CC,IAA3C,CAAgD,UAACC,MAAD,EAAY;AAC1D,UAAMC,iBAAiBD,OAAOF,cAAP,CAAsBI,eAA7C;AACE,UAAI7B,cAAcC,GAAd,CAAkB,OAAlB,CAAJ,EAAgC;AAChCqB,oCAAQC,MAAR,CAAeO,SAAf,GAA2BJ,IAA3B,CAAgC,UAACK,GAAD,EAAS;AACvC,cAAMC,UAAUhC,cAAcC,GAAd,CAAkB,WAAlB,EAA+B+B,OAA/C;AACAV,sCAAQE,IAAR,CAAa,EAAES,iBAAiBD,OAAnB,EAAb,EAA2CN,IAA3C,CAAgD,UAACQ,IAAD,EAAU;AACxD,gBAAMD,kBAAkBC,KAAKD,eAA7B;AACA,gBAAKE,YAAYH,OAAZ,EAAqBC,eAArB,KAAyC5C,iBAAiB0C,IAAID,SAArB,CAA1C,IACA1B,WAAWR,MAAX,IAAqB,CAArB,IAA0BwC,oBAAoBR,cAApB,CAD9B,EACoE;AAClEnB,qBAAO4B,SAAP,CAAiBC,MAAjB,CAAwB,WAAxB;AACD,aAHD,MAGO;AACL7B,qBAAO4B,SAAP,CAAiBE,GAAjB,CAAqB,WAArB;AACD;AACF,WARD;AASD,SAXD;AAYD,OAbC,MAaK;AACLjB,oCAAQE,IAAR,CAAa,EAAES,iBAAiBL,cAAnB,EAAb,EAAkDF,IAAlD,CAAuD,UAACc,QAAD,EAAc;AACnE,cAAMP,kBAAkBO,SAASP,eAAjC;AACA,cAAIE,YAAYP,cAAZ,EAA4BK,eAA5B,CAAJ,EAAkD;AAChDxB,mBAAO4B,SAAP,CAAiBC,MAAjB,CAAwB,WAAxB;AACD,WAFD,MAEO;AACL7B,mBAAO4B,SAAP,CAAiBE,GAAjB,CAAqB,WAArB;AACD;AACF,SAPD;AAQD;AACF,KAzBD;AA2BD,GA7BD;;AA+BAjB,8BAAQmB,MAAR,CAAeC,EAAf,CAAkB,OAAlB,EAA2B,YAAM;AAC/BrB;AACD,GAFD;AAGAC,8BAAQmB,MAAR,CAAeC,EAAf,CAAkB,QAAlB,EAA4B,YAAM;AAChCrB;AACD,GAFD;AAGAC,8BAAQmB,MAAR,CAAeC,EAAf,CAAkB,gBAAlB,EAAoC,YAAM;AACxCrB;AACD,GAFD;;oBAIe;AACbb;AADa,G","file":"banners.js","sourcesContent":["import $banner from \"text!./banners.html\";\nimport liveapi from \"../websockets/binary_websockets\";\nimport \"css!banners/banners.css\";\n\n\nconst shouldShowBanner = (auth) => {\n  const has_mf  = auth.account_list.filter( item => item.landing_company_name === 'maltainvest').length;\n  const has_mlt = auth.account_list.filter( item => item.landing_company_name === 'malta').length;\n  const has_iom = auth.account_list.filter( item => item.landing_company_name === 'iom').length;\n  const current_loginId =  local_storage.get('authorize').loginid;\n  const getLoginId = loginids().filter( item => item.id === current_loginId);\n  const is_mf = getLoginId[0].is_mf;\n  const is_virtual = getLoginId[0].is_virtual;\n  if (is_mf) {\n    return true;\n  } else if (is_virtual && has_mf && !has_iom && !has_mlt) {\n    return true;\n  }\n  return false;\n};\n\nexport const init = () => {\n  const banner = $($banner).i18n();\n  const nav = $(\"body\").find(\"nav\");\n  nav.after(banner);\n  const go_to_deriv_el = document.getElementById(\"close_banner_btn_iom\");\n  go_to_deriv_el.href = getDerivUrl(\"\");\n  showBanner();\n};\n\nconst showBanner = () => {\n  const banner = document.getElementById(\"close_banner_container\");\n  liveapi.cached.send({ website_status: 1 }).then((status) => {\n    const client_country = status.website_status.clients_country;\n      if (local_storage.get(\"oauth\")) {\n      liveapi.cached.authorize().then((res) => {\n        const country = local_storage.get(\"authorize\").country;\n        liveapi.send({ landing_company: country }).then((data) => {\n          const landing_company = data.landing_company;\n          if ((isEuCountry(country, landing_company) && shouldShowBanner(res.authorize))\n          || (loginids().length == 1 && isEuCountrySelected(client_country))) {\n            banner.classList.remove(\"invisible\");\n          } else {\n            banner.classList.add(\"invisible\");\n          }\n        });\n      });\n    } else {\n      liveapi.send({ landing_company: client_country }).then((response) => {\n        const landing_company = response.landing_company;\n        if (isEuCountry(client_country, landing_company)) {\n          banner.classList.remove(\"invisible\");\n        } else {\n          banner.classList.add(\"invisible\");\n        }\n      });\n    }\n  })\n  \n};\n\nliveapi.events.on(\"login\", () => {\n  showBanner();\n});\nliveapi.events.on(\"logout\", () => {\n  showBanner();\n});\nliveapi.events.on(\"switch_account\", () => {\n  showBanner()\n});\n\nexport default {\n  init,\n};\n"]}